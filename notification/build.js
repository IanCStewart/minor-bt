'use strict';function handleSubmit(a){if(supportsFetch())geDataFetch(form.action),a.preventDefault();else if(supportsXHR())getDataXml(form.action,a),a.preventDefault();else return!1}function geDataFetch(a){fetch(a,{type:'text/html'}).then(function(a){return a.text()}).then(function(a){return getHtml(a)}).catch(function(a){return renderNotificationError(a)})}function getDataXml(b){var a=new XMLHttpRequest;a.onerror=function(a){return console.warn('Something went wrong',a),!1},a.onload=function(){if(!(this.statusText==='OK'))return renderNotificationError();getHtml(this.responseXML.body.outerHTML)},a.open('GET',b),a.responseType='document',a.send()}function getHtml(c){var b=document.createElement('div');b.innerHTML=c;var a=b.querySelector('.notification');a.querySelector('img').src=getPictureUri()||a.querySelector('img').src,a.querySelector('img').alt=getPictureAlt()||'logo-team',a.querySelector('h2').innerHTML='The Score',setTimeout(function(){return renderNotification(a)},1e4),supportsNotification()&&checkNotificationPermission(a)}function getPictureUri(){var a=document.querySelector('input[name="team"]:checked + img');return a?a.src:null}function getPictureAlt(){var a=document.querySelector('input[name="team"]:checked + img');return a?a.alt:null}function renderNotification(a){document.querySelector('.notify').innerHTML=a.outerHTML,playNotificationSound(),changeTabTitle()}function renderNotificationError(){document.querySelector('.notify').innerHTML='\n    <section class="notification">\n      <h1>Something went wrong!</h1>\n      <p>please try again later</p>\n    </section>\n  '}function checkNotificationPermission(e){var a=e.querySelector('p').innerHTML,b=e.querySelector('img').alt,c=b+' scored!';a=a.replace(/\<em>|<\/em>/g,'');var d={icon:'./assets/'+b+'.png',body:a,id:'nhl-score-notify'};Notification.permission==='granted'?sendNotification(c,d):Notification.permission!=='denied'&&Notification.requestPermission(function(a){return a==='granted'?sendNotification(c,d):!1})}function sendNotification(a,b){setTimeout(function(){return new Notification(a,b),console.log('%c '+a,'font-size: 2rem'),console.log('%c '+b.body,'font-size: 1.4rem')},1e4)}function playNotificationSound(){if('Audio'in window)if(new Audio().canPlayType(0)){var a=new Audio('/assets/notify.ogg');a.play()}else{var b=new Audio('/assets/notify.wav');b.play()}return!1}function changeTabTitle(){'hidden'in document&&document.hidden&&(document.title='(1) '+document.title)}function supportsXHR(){return window.XMLHttpRequest?!0:!1}function supportsFetch(){return'fetch'in window?!0:!1}function supportsNotification(){return'Notification'in window?!0:!1}var form=document.querySelector('form');form.addEventListener('submit',handleSubmit,!1)
